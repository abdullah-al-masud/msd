

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>utils &mdash; msdlib 1.1.9 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_objects.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="dataset" href="dataset.html" />
    <link rel="prev" title="mlutils.modeling" href="mlutils.modeling.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> msdlib
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Intro</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="README.html">msdlib</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">msd</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="msd.html">msd</a></li>
<li class="toctree-l1"><a class="reference internal" href="msd.processing.html">msd.processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="msd.vis.html">msd.vis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">mlutils</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="mlutils.html">mlutils.mlutils</a></li>
<li class="toctree-l1"><a class="reference internal" href="mlutils.modeling.html">mlutils.modeling</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">utils</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#msdlib.mlutils.utils.DataSet"><code class="docutils literal notranslate"><span class="pre">DataSet</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#msdlib.mlutils.utils.define_layers"><code class="docutils literal notranslate"><span class="pre">define_layers()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#msdlib.mlutils.utils.evaluate_with_data"><code class="docutils literal notranslate"><span class="pre">evaluate_with_data()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#msdlib.mlutils.utils.get_factors"><code class="docutils literal notranslate"><span class="pre">get_factors()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#msdlib.mlutils.utils.load_models"><code class="docutils literal notranslate"><span class="pre">load_models()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#msdlib.mlutils.utils.store_models"><code class="docutils literal notranslate"><span class="pre">store_models()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#msdlib.mlutils.utils.train_with_data"><code class="docutils literal notranslate"><span class="pre">train_with_data()</span></code></a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">others</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="dataset.html">dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="msdbacktest.html">msdbacktest</a></li>
<li class="toctree-l1"><a class="reference internal" href="stats.html">stats</a></li>
<li class="toctree-l1"><a class="reference internal" href="msdExceptions.html">msdExceptions</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">msdlib</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>utils</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/mlutils.utils.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="utils">
<h1>utils<a class="headerlink" href="#utils" title="Permalink to this heading">¶</a></h1>
<p>This is a sub-module containing utility functions for multiple model training including scikit-learn models.
It also contains several other utility for model storing and loading, Neural Network model building, custom DataSet for pytorch etc.</p>
<span class="target" id="module-msdlib.mlutils.utils"></span><p>Author : Abdullah Al Masud</p>
<p>email : <a class="reference external" href="mailto:abdullahalmasud&#46;buet&#37;&#52;&#48;gmail&#46;com">abdullahalmasud<span>&#46;</span>buet<span>&#64;</span>gmail<span>&#46;</span>com</a></p>
<p>LICENSE : MIT License</p>
<dl class="py class">
<dt class="sig sig-object py" id="msdlib.mlutils.utils.DataSet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">msdlib.mlutils.utils.</span></span><span class="sig-name descname"><span class="pre">DataSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'regressor'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#msdlib.mlutils.utils.DataSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></p>
<p>This is a customized Data set object which can build a torch.utils.data.Dataset object given the data and labels. 
This is only usable when we have complete data and labels (data and label lengths must be equal)</p>
<dl class="simple">
<dt>Inputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">data<span class="colon">:</span></dt>
<dd class="field-odd"><p>ideally should be torch tensor. Contains feature data tor model training.
Can be python list or python set too but not much appreciated as it will be mostly used for training pytorch model.</p>
</dd>
<dt class="field-even">label<span class="colon">:</span></dt>
<dd class="field-even"><p>ideally should be numpy ndarray, pandas Series/DataFrame or torch tensor. Contains true labels tor model training.
Can be python list or python set too but not much appreciated as it will be mostly used for training pytorch model.</p>
</dd>
<dt class="field-odd">dtype<span class="colon">:</span></dt>
<dd class="field-odd"><p>data type of the data and labels. Default is torch.float32. It also depends on model_type parameter for label data.</p>
</dd>
<dt class="field-even">model_type<span class="colon">:</span></dt>
<dd class="field-even"><p>{‘regressor’, ‘binary-classifier’ or ‘multi-classifier’}. Default is ‘multi-classifier’.
It is used to confirm that for multi-class classification, label data type is torch.long.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="msdlib.mlutils.utils.define_layers">
<span class="sig-prename descclassname"><span class="pre">msdlib.mlutils.utils.</span></span><span class="sig-name descname"><span class="pre">define_layers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_factors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'regressor'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actual_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#msdlib.mlutils.utils.define_layers" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes a common formation/sequence of functions to construct one hidden layer and then replicates this sequence for multiple hidden layers.
Hidden layer units are decided based on ‘unit_factors’ paramter.
The common formation of one hidden layer is this-</p>
<blockquote>
<div><p>-Linear
-BatchNorm1d
-ReLU
-Dropout</p>
</div></blockquote>
<p>Dropout ratio is same in all layers</p>
<p>Finally the output layer is constructed depending on ‘output_units’ and ‘model_type’ parameter including final activation function.
Output activation function is provided</p>
<dl class="simple">
<dt>Inputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">input_units<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, number of units in input layer / number of features (not first hidden layer)</p>
</dd>
<dt class="field-even">output_units<span class="colon">:</span></dt>
<dd class="field-even"><p>int, number of units in output layer / number of output nodes / number of classes (not last hidden layer)</p>
</dd>
<dt class="field-odd">unit_factors<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of ints or floats, multipliers to calculate number of units in each hidden layer from input_units, or actual number of units for each hidden layer</p>
</dd>
<dt class="field-even">dropout_rate<span class="colon">:</span></dt>
<dd class="field-even"><p>dropout ratio, must be 0 ~ 1. Default is None (no dropout layer)</p>
</dd>
<dt class="field-odd">model_type<span class="colon">:</span></dt>
<dd class="field-odd"><p>{‘binary-classifier’, ‘multi-classifier, ‘regressor’}, controls use of softmax/sigmoid at the output layer. Use ‘regressor’ if you dont intend to use any activation at output. Default is ‘regressor’</p>
</dd>
<dt class="field-even">actual_units<span class="colon">:</span></dt>
<dd class="field-even"><p>bool, whether actual units are placed in unit_factors or not, default is False (not actual units, instead unit_factos is containing ratios)</p>
</dd>
<dt class="field-odd">apply_bn<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool, whether to use batch normalization or not, default is False (does not use batch normalization)</p>
</dd>
<dt class="field-even">activation<span class="colon">:</span></dt>
<dd class="field-even"><p>nn.Module object or None. Pytorch activation layer that will be used as activation function after each hidden layer. Default is None (No activation)</p>
</dd>
<dt class="field-odd">final_activation<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.sigmoid / torch.Softmax(dim=1) / torch.tanh etc. for output layer, default is None. If None, the final activation will be below:
- modey_type == ‘regressor’ –&gt; No activation
- model_type == ‘binary-classifier’ –&gt; torch.sigmoid
- model_type == ‘multi-clussifier’ –&gt; torch.Softmax(dim=1)</p>
</dd>
</dl>
</dd>
<dt>Outputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">layers<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of Deep Learning model layers which can be fed as NNModel layer_funcs input or torchModel layers input to build DNN model</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="msdlib.mlutils.utils.evaluate_with_data">
<span class="sig-prename descclassname"><span class="pre">msdlib.mlutils.utils.</span></span><span class="sig-name descname"><span class="pre">evaluate_with_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">models</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'multi-classifier'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(15,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xrot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#msdlib.mlutils.utils.evaluate_with_data" title="Permalink to this definition">¶</a></dt>
<dd><p>This function will be used to train models. We can use both scikit-models and torchModel objects for model training.</p>
<dl class="simple">
<dt>Inputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">outdata<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict, contains dicts with structure like : outdata = {‘train’: {‘data’: &lt;numpy-array&gt;, ‘label’: &lt;numpy-array&gt;, ‘index’: &lt;numpy-array&gt;}}
‘train’ dict is mandatory. ‘validation’ dict is mandatory for torchModel objects inside “models” argument.
‘data’, ‘label’ and ‘index’ must be of same length.</p>
</dd>
<dt class="field-even">models<span class="colon">:</span></dt>
<dd class="field-even"><p>dict, contains scikit-models, xgboost, lightgbm etc. scikit-like models and torchModel objects. 
If its a torchModel object, the key must contain ‘pytorch’ in it.</p>
</dd>
<dt class="field-odd">figure_dir<span class="colon">:</span></dt>
<dd class="field-odd"><p>string/None, path to the directory where figures will be saved for feature improtances and evaluation figures.</p>
</dd>
<dt class="field-even">model_type<span class="colon">:</span></dt>
<dd class="field-even"><p>string, can be either ‘regressor’, ‘multi-classifier’ or ‘binary-classifier’. It controls the evaluation process.</p>
</dd>
<dt class="field-odd">figsize<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of horiaontal and vertical size of the result figure (regression score and classification score both). Default is (15, 5).</p>
</dd>
<dt class="field-even">xrot<span class="colon">:</span></dt>
<dd class="field-even"><p>float, rotation angle of the x axis labels in classification score matrix (where class label names are written). Default is 0 (no rotation).</p>
</dd>
</dl>
</dd>
<dt>Outputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">predictions<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict, contains detailed predictions on all sets in outdata argument, evaluation results etc.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="msdlib.mlutils.utils.get_factors">
<span class="sig-prename descclassname"><span class="pre">msdlib.mlutils.utils.</span></span><span class="sig-name descname"><span class="pre">get_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#msdlib.mlutils.utils.get_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>This function calculates factors/multipliers to calculate number of units inside define_layers() function</p>
<dl class="simple">
<dt>Inputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">n_layers<span class="colon">:</span></dt>
<dd class="field-odd"><p>number of hidden layers</p>
</dd>
<dt class="field-even">max_factor<span class="colon">:</span></dt>
<dd class="field-even"><p>multiplier for mid layer (largest layer)</p>
</dd>
<dt class="field-odd">base_factor<span class="colon">:</span></dt>
<dd class="field-odd"><p>multiplier for first layer</p>
</dd>
<dt class="field-even">offset_factor<span class="colon">:</span></dt>
<dd class="field-even"><p>makes assymetric structure in output with factor (base - offset). For symmetric model (size in first and last hidden layer is same), offset will be 0.</p>
</dd>
</dl>
</dd>
<dt>Outputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">factors<span class="colon">:</span></dt>
<dd class="field-odd"><p>multipliers to calculate number of units in each layers based on input shape</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="msdlib.mlutils.utils.load_models">
<span class="sig-prename descclassname"><span class="pre">msdlib.mlutils.utils.</span></span><span class="sig-name descname"><span class="pre">load_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">models</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#msdlib.mlutils.utils.load_models" title="Permalink to this definition">¶</a></dt>
<dd><p>This function loads different scikit-learn models from .pickle format and Pytorch model from .pt formatted state_dict (only weights)</p>
<dl>
<dt>Inputs:</dt><dd><dl class="field-list">
<dt class="field-odd">models<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict, containing model classes or None (for torch model, torch.nn.Module object is necessary as trained model 
to load the state variables. For other types of models like xgboost etc. None is fine.);
For pytorch models, the key must contain ‘pytorch’ phrase (Case insensitive)
key name must be like this :</p>
<blockquote>
<div><p>stored model file name: xgboost_model.pickle</p>
<p>corresponding key for the dict: ‘xgboost’</p>
<p>stored model file name: pytorch-1_model.pickle</p>
<p>corresponding key for the dict: ‘pytorch-1’</p>
</div></blockquote>
<p>for pytorch model, the model must not be a DataParallel model. You can add parallelism after loading the weights</p>
</dd>
<dt class="field-even">folder_path<span class="colon">:</span></dt>
<dd class="field-even"><p>str, directory path from where the stored models will be loaded</p>
</dd>
</dl>
</dd>
<dt>Outputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">models<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict, containing model classes like {&lt;model_name&gt; : &lt;model_class&gt;}</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="msdlib.mlutils.utils.store_models">
<span class="sig-prename descclassname"><span class="pre">msdlib.mlutils.utils.</span></span><span class="sig-name descname"><span class="pre">store_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">models</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#msdlib.mlutils.utils.store_models" title="Permalink to this definition">¶</a></dt>
<dd><p>This function stores different types of scikit-learn models in .pickle format and also Pytorch model in .pt format</p>
<dl>
<dt>Inputs:</dt><dd><dl class="field-list">
<dt class="field-odd">models<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict, containing only trained model class; {&lt;model name&gt;: &lt;model class&gt;}
For pytorch models, the key must contain ‘pytorch’ phrase (Case insensitive).</p>
<p>Note: Pytorch model must not be a DataParallel model.</p>
<p>If its a DataParallel model, then take module attribute of your model like this- {‘pytorch’: &lt;your_model&gt;.module}</p>
</dd>
<dt class="field-even">folder_path<span class="colon">:</span></dt>
<dd class="field-even"><p>str, the folder path where the models will be stores, if doesnt exist, it will be created</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="msdlib.mlutils.utils.train_with_data">
<span class="sig-prename descclassname"><span class="pre">msdlib.mlutils.utils.</span></span><span class="sig-name descname"><span class="pre">train_with_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_columns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">models</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">featimp_models</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'multi-classifier'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">featimp_figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(30,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(15,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xrot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#msdlib.mlutils.utils.train_with_data" title="Permalink to this definition">¶</a></dt>
<dd><p>This function will be used to train models. We can use both scikit-models and torchModel objects for model training.</p>
<dl class="simple">
<dt>Inputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">outdata<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict, contains dicts with structure like : outdata = {‘train’: {‘data’: &lt;numpy-array&gt;, ‘label’: &lt;numpy-array&gt;, ‘index’: &lt;numpy-array&gt;}}
‘train’ dict is mandatory. ‘validation’ dict is mandatory for torchModel objects inside “models” argument.
‘data’, ‘label’ and ‘index’ must be of same length.</p>
</dd>
<dt class="field-even">feature_columns<span class="colon">:</span></dt>
<dd class="field-even"><p>list/numpy array, contains feature names of ‘data’ inside outdata. seature_columns length must be equal to number of columns in ‘data’</p>
</dd>
<dt class="field-odd">models<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict, contains scikit-models, xgboost, lightgbm etc. scikit-like models and torchModel objects. 
If its a torchModel object, the key must contain ‘pytorch’ in it.</p>
</dd>
<dt class="field-even">featimp_models<span class="colon">:</span></dt>
<dd class="field-even"><p>list of strings, contains model names which belong to models dict keys and which can provide feature importances</p>
</dd>
<dt class="field-odd">figure_dir<span class="colon">:</span></dt>
<dd class="field-odd"><p>string/None, path to the directory where figures will be saved for feature improtances and evaluation figures.</p>
</dd>
<dt class="field-even">model_type<span class="colon">:</span></dt>
<dd class="field-even"><p>string, can be either ‘regressor’, ‘multi-classifier’ or ‘binary-classifier’. It controls the evaluation process.</p>
</dd>
<dt class="field-odd">evaluate<span class="colon">:</span></dt>
<dd class="field-odd"><p>boolean, If True, model evaluation will be executed and results of evaluation will be stored inside figure_dir. Default is True.</p>
</dd>
<dt class="field-even">featimp_figsize<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple of horiaontal and vertical size of the feature importance plot. Default is (30, 5).</p>
</dd>
<dt class="field-odd">figsize<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of horiaontal and vertical size of the result figure (regression score and classification score both). Default is (15, 5). 
Only effective when evaluate is True.</p>
</dd>
<dt class="field-even">xrot<span class="colon">:</span></dt>
<dd class="field-even"><p>float, rotation angle of the x axis labels in classification score matrix (where class label names are written). Default is 0 (no rotation).
Only effective when evaluate is True.</p>
</dd>
</dl>
</dd>
<dt>Outputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">models<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict, contains trained models instances, same as ‘models’ argument</p>
</dd>
<dt class="field-even">predictions<span class="colon">:</span></dt>
<dd class="field-even"><p>dict, contains detailed predictions on all sets in outdata argument, evaluation results etc.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="dataset.html" class="btn btn-neutral float-right" title="dataset" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="mlutils.modeling.html" class="btn btn-neutral float-left" title="mlutils.modeling" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Abdullah Al Masud.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>